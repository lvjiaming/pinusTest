"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.GameLogic = void 0;
const define_1 = require("./define");
const MASK_COLOR = 0xF0;
const MASK_VALUE = 0x0F;
var SAME;
(function (SAME) {
    SAME[SAME["KING"] = 0] = "KING";
    SAME[SAME["ONE"] = 1] = "ONE";
    SAME[SAME["TWO"] = 2] = "TWO";
    SAME[SAME["THREE"] = 3] = "THREE";
    SAME[SAME["FOUR"] = 4] = "FOUR";
})(SAME || (SAME = {}));
class GameLogic {
    constructor() {
        this.rules = [];
        this.cardLibrary = [
            0x01, 0x02, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D,
            0x11, 0x12, 0x16, 0x17, 0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D,
            0x21, 0x22, 0x26, 0x27, 0x28, 0x29, 0x2A, 0x2B, 0x2C, 0x2D,
            0x31, 0x32, 0x36, 0x37, 0x38, 0x39, 0x3A, 0x3B, 0x3C, 0x3D,
            0x4E, 0x4F,
            0x03, 0x04, 0x05,
            0x13, 0x14, 0x15,
            0x23, 0x24, 0x25,
            0x33, 0x34, 0x35,
        ];
    }
    setRules(rules) {
        this.rules = rules;
    }
    _hasRule(rule) {
        return (this.rules[0] & rule) > 0;
    }
    getColor(cardData) {
        return (cardData & MASK_COLOR) >> 4;
    }
    getValue(cardData) {
        return (cardData & MASK_VALUE);
    }
    getLogicValue(card) {
        let value = this.getValue(card);
        let color = this.getColor(card);
        if (color == 4)
            return value + 2;
        else
            return value <= 2 ? (value + 13) : value;
    }
    // 返回 max~min 中的随机整数 不包括max 包括min
    getRandomValue(max, min) {
        if (min === undefined) {
            min = 0;
        }
        return Math.floor(Math.random() * (max - min)) + min;
    }
    shuffle() {
        let cards = [];
        let cardLibrary = this.cardLibrary.slice(0);
        if (this._hasRule(define_1.RULE.NO_345)) {
            cardLibrary = cardLibrary.slice(0, -12);
        }
        while (cardLibrary.length !== 0) {
            let pos = this.getRandomValue(cardLibrary.length);
            cards.push(cardLibrary.splice(pos, 1)[0]);
        }
        return cards;
    }
    // 判断是否有4个2或者俩王
    checkGoodCard(cards) {
        if (!this._hasRule(define_1.RULE.GOOD_CALL))
            return false;
        let cnt2 = 0, kingCnt = 0;
        cards.forEach(card => {
            if (this.getValue(card) == 2)
                cnt2++;
            if (this.getColor(card) == 4)
                kingCnt++;
        });
        return cnt2 == 4 || kingCnt == 2;
    }
    getCardType(cards) {
        if (cards.length == 0) {
            console.log('getCardType error length = 0');
            return define_1.TYPE.ERROR;
        }
        else if (cards.length == 1)
            return define_1.TYPE.SINGLE;
        let res = this.analyzeCard(cards);
        if (cards.length == 2) {
            if (res[SAME.KING].length == 2)
                return define_1.TYPE.MISSILE;
            if (res[SAME.TWO].length == 1)
                return define_1.TYPE.DOUBLE;
        }
        if (res[SAME.FOUR].length == 1) {
            if (cards.length == 4)
                return define_1.TYPE.BOMB;
            if (cards.length == 6 && (res[SAME.ONE].length == 2 ||
                (res[SAME.ONE].length == 1 && res[SAME.KING].length == 1)))
                return define_1.TYPE.FOUR_TAKE_ONE;
            if (cards.length == 8 && res[SAME.TWO].length == 2)
                return define_1.TYPE.FOUR_TAKE_TWO;
        }
        if (res[SAME.THREE].length == 1) {
            if (cards.length == 3)
                return define_1.TYPE.THREE;
            if (cards.length == 4 && (res[SAME.ONE].length == 1 || res[SAME.KING].length == 1))
                return define_1.TYPE.THREE_TAKE_ONE;
            if (cards.length == 5 && res[SAME.TWO].length == 1)
                return define_1.TYPE.THREE_TAKE_TWO;
        }
        let checkLine = (values) => {
            let first = values[0];
            if (first > 14)
                return false;
            for (let i = 1; i < values.length; i++) {
                if (first - i != values[i])
                    return false;
            }
            return true;
        };
        if (res[SAME.THREE].length > 1 && checkLine(res[SAME.THREE])) {
            if (cards.length == (res[SAME.THREE].length * 3))
                return define_1.TYPE.THREE_LINE;
            if (res[SAME.TWO].length == res[SAME.THREE].length &&
                cards.length == (res[SAME.THREE].length * 3 + res[SAME.TWO].length * 2))
                return define_1.TYPE.THREE_LINE_TAKE_TWO;
            if (res[SAME.ONE].length == res[SAME.THREE].length &&
                cards.length == (res[SAME.THREE].length * 3 + res[SAME.ONE].length))
                return define_1.TYPE.THREE_LINE_TAKE_ONE;
        }
        if (res[SAME.ONE].length >= 5 && checkLine(res[SAME.ONE]) &&
            res[SAME.ONE].length == cards.length)
            return define_1.TYPE.SINGLE_LINE;
        if (res[SAME.TWO].length >= 3 && checkLine(res[SAME.TWO]) &&
            cards.length == 2 * res[SAME.TWO].length)
            return define_1.TYPE.DOUBLE_LINE;
        if (res[SAME.THREE].length >= 3 && checkLine(res[SAME.THREE]) &&
            cards.length == 3 * res[SAME.THREE].length)
            return define_1.TYPE.THREE_LINE;
        console.log('getCardType error', cards);
        return define_1.TYPE.ERROR;
    }
    // 大到小排序
    sortCard(cards) {
        cards.sort((a, b) => {
            if (this.getLogicValue(a) < this.getLogicValue(b))
                return 1;
            else if (this.getLogicValue(a) > this.getLogicValue(b))
                return -1;
            else {
                if (a < b)
                    return 1;
                else if (a > b)
                    return -1;
                else
                    return 0;
            }
        });
    }
    // 分析牌, 1234张同牌的数量
    analyzeCard(cardData) {
        let res = [];
        for (let i = SAME.KING; i <= SAME.FOUR; i++) {
            res[i] = [];
        }
        let sameCnt = 0;
        let cards = cardData.slice(0);
        this.sortCard(cards);
        for (let i = 0; i < cards.length; i++) {
            if (cards[i] == 0)
                continue;
            let value = this.getLogicValue(cards[i]);
            if (this.getColor(cards[i]) == 4) {
                res[SAME.KING].push(value);
                continue;
            }
            sameCnt = 1;
            for (let j = i + 1; j < cards.length; j++) {
                if (this.getLogicValue(cards[j]) == value) {
                    sameCnt++;
                }
            }
            if (sameCnt > SAME.FOUR) {
                console.log('analyzeCard error sameCnt:' + sameCnt);
                return res;
            }
            res[sameCnt].push(value);
            i += sameCnt - 1;
        }
        return res;
    }
    // true A 大 false B 大
    compareCard(cardsA, cardsB) {
        let typeA = this.getCardType(cardsA);
        let typeB = this.getCardType(cardsB);
        if (typeA == define_1.TYPE.MISSILE)
            return true;
        if (typeB == define_1.TYPE.MISSILE)
            return false;
        if (typeA != typeB) {
            if (typeA == define_1.TYPE.BOMB)
                return true;
            if (typeB == define_1.TYPE.BOMB)
                return false;
            console.log('compareCard type error', cardsA, cardsB);
            return false;
        }
        if (cardsA.length != cardsB.length) {
            console.log('compareCard length error', cardsA, cardsB);
            return false;
        }
        switch (typeA) {
            case define_1.TYPE.SINGLE:
            case define_1.TYPE.DOUBLE:
            case define_1.TYPE.THREE:
            case define_1.TYPE.SINGLE_LINE:
            case define_1.TYPE.DOUBLE_LINE:
            case define_1.TYPE.THREE_LINE:
            case define_1.TYPE.BOMB: {
                return this.getLogicValue(cardsA[0]) > this.getLogicValue(cardsB[0]);
            }
            case define_1.TYPE.THREE_TAKE_ONE:
            case define_1.TYPE.THREE_TAKE_TWO:
            case define_1.TYPE.FOUR_TAKE_ONE:
            case define_1.TYPE.FOUR_TAKE_TWO:
            case define_1.TYPE.THREE_LINE_TAKE_ONE:
            case define_1.TYPE.THREE_LINE_TAKE_TWO: {
                let resA = this.analyzeCard(cardsA);
                let resB = this.analyzeCard(cardsB);
                if (typeA == define_1.TYPE.FOUR_TAKE_ONE || typeA == define_1.TYPE.FOUR_TAKE_TWO) {
                    return this.getLogicValue(resA[SAME.FOUR][0]) > this.getLogicValue(resB[SAME.FOUR][0]);
                }
                else {
                    return this.getLogicValue(resA[SAME.THREE][0]) > this.getLogicValue(resB[SAME.THREE][0]);
                }
            }
        }
        console.log('compareCard ' + typeA, cardsA, cardsB);
        return false;
    }
    // A-B 改变 A, 返回true成功 返回false失败
    removeCards(cardsA, cardsB) {
        for (let i in cardsB) {
            let isFind = false;
            for (let j = 0; j < cardsA.length; j++) {
                if (cardsA[j] == cardsB[i]) {
                    isFind = true;
                    cardsA.splice(j, 1);
                    break;
                }
            }
            if (!isFind) {
                console.trace('removeCards error', cardsA, cardsB);
                return false;
            }
        }
        return true;
    }
}
exports.GameLogic = GameLogic;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2FtZUxvZ2ljLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vYXBwL2dhbWUvNDAxMDcvZ2FtZUxvZ2ljLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLHFDQUFzQztBQUd0QyxNQUFNLFVBQVUsR0FBRyxJQUFJLENBQUM7QUFDeEIsTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDO0FBRXhCLElBQUssSUFNSjtBQU5ELFdBQUssSUFBSTtJQUNMLCtCQUFRLENBQUE7SUFDUiw2QkFBRyxDQUFBO0lBQ0gsNkJBQUcsQ0FBQTtJQUNILGlDQUFLLENBQUE7SUFDTCwrQkFBSSxDQUFBO0FBQ1IsQ0FBQyxFQU5JLElBQUksS0FBSixJQUFJLFFBTVI7QUFHRCxNQUFhLFNBQVM7SUFnQmxCO1FBZEEsVUFBSyxHQUFhLEVBQUUsQ0FBQztRQUVyQixnQkFBVyxHQUFhO1lBQ3BCLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUk7WUFDMUQsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSTtZQUMxRCxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJO1lBQzFELElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUk7WUFDMUQsSUFBSSxFQUFFLElBQUk7WUFDVixJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUk7WUFDaEIsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJ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